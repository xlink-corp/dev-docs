# 制造成本分析

本手册介绍“制造成本分析”模块的页面入口、成本录入方式、分层分析与对比分析能力，并说明导出与常见问题排查。

> 说明：本手册**不覆盖**“能源购入费-自动计算”与“标准单成本/标准单位”等口径细节，仅描述页面视图与操作。

---

## 1. 模块概述

### 1.1 功能定位

“制造成本分析”用于按**月份**管理制造成本，并在**全厂 / 车间 / 产线**不同层级进行趋势、结构与对比分析，支持一键导出 Excel 进行对账与归档。

### 1.2 页面入口

- 菜单：制造成本分析

### 1.3 成本分类（录入字段）

系统按以下成本分项组织录入与展示：

| 成本项 | 说明 |
|---|---|
| 能源购入费 | 电/水/燃气/蒸汽等能源购入成本 |
| 药剂费 | 生产过程中使用的化学药剂费用 |
| 维修费 | 设备维护维修相关费用 |
| 其他费用 | 其他补充费用（可填写说明） |

> 页面会展示“制造总成本（合计）”，通常为上述分项的合计结果。

### 1.4 前置准备

为便于按层级分析与对比，建议先完成：

1. 已创建组织并具备访问权限。
2. 已维护“空间/车间”主数据（用于按车间维度录入/筛选）。
3. 已维护“产线”并关联到对应车间（用于按产线维度录入/筛选）。

---

## 2. 快速入门（常见场景）

### 场景 A：录入某月“全厂”制造成本并导出

1. 进入 **制造成本分析** 页面。
2. 在页面顶部选择目标 **年份**。
3. 切换到 Tab：**成本录入**。
4. 点击 **添加成本记录**，在弹窗中：
   - 选择目标 **月份**
   - 不选择车间/产线（表示“全厂”）
   - 填写各成本分项与备注
   - 保存
5. 回到页面顶部点击 **导出 Excel**，生成当年报表文件。

### 场景 B：录入“车间级 / 产线级”成本，用于对比分析

1. 在 Tab：**成本录入** 点击 **添加成本记录**。
2. 选择月份后：
   - 车间级：选择 **车间**，不选择产线
   - 产线级：选择 **车间** + **产线**
3. 按实际台账填写分项成本并保存。
4. 切换到 Tab：**对比分析**，查看车间/产线间成本结构差异。

### 场景 C：查看成本趋势与占比，并切换“直接数据/汇总数据”视图

1. 切换到 Tab：**成本分析**。
2. 选择分析层级（全厂/车间/产线）并选择目标对象。
3. 使用 **直接数据 / 汇总数据** 切换按钮观察指标与图表变化。

---

## 3. 功能详解

### 3.1 页面通用操作（年份 / 刷新 / 导出）

页面顶部通常包含以下通用操作：

1. **年份选择**：影响当前页面所有 Tab 的数据范围。
2. **刷新**：重新拉取当前年份/当前筛选条件下的数据。
3. **导出 Excel**：导出当前年份的制造成本数据用于对账与归档。

> 若当年没有任何成本记录，导出可能提示“暂无数据可导出”。

### 3.2 成本录入（Tab：成本录入）

#### 3.2.1 月度卡片与记录组织方式

“成本录入”以 12 个月卡片形式展示：

- 每张月份卡片代表一个月份。
- **同一个月份可能出现多条记录**：通常代表不同维度（全厂 / 不同车间 / 不同产线）的独立成本记录。

#### 3.2.2 新增成本记录

有两类常见入口：

1. 页面按钮 **添加成本记录**（新增一条记录）
2. 在某个月份卡片上使用 **新增**（在指定月份下新增）

新增时通常需要填写：

- 月份
- 维度（全厂 / 车间 / 产线）
- 成本分项（能源购入费、药剂费、维修费、其他费用）
- 其他费用说明（可选）
- 备注（可选）

#### 3.2.3 编辑成本记录

1. 在月份卡片中找到目标记录。
2. 点击记录进入编辑弹窗。
3. 修改字段并保存。

#### 3.2.4 删除成本记录

1. 打开目标记录的编辑弹窗。
2. 点击 **删除** 并确认。

> 建议：删除前先导出或在备注中保留变更原因，便于对账追溯。

---

### 3.3 成本分析（Tab：成本分析）

“成本分析”用于查看指标卡与趋势/结构图表，并支持按层级筛选。

#### 3.3.1 层级选择（全厂 / 车间 / 产线）

在层级选择器中：

- 选择 **全厂**：展示全厂范围的数据。
- 选择 **车间**：需要进一步选择目标车间。
- 选择 **产线**：通常需要选择目标车间后，再选择目标产线。

若未选中具体对象或目标对象在该年份无记录，页面可能显示为空或提示无数据。

#### 3.3.2 视图模式切换（直接数据 / 汇总数据）

在支持切换的层级下，可使用：

- **直接数据**：展示当前层级直接录入/直接汇总的数据视图。
- **汇总数据**：展示汇总视图。

> 本手册仅说明按钮与视图切换，不解释汇总口径与计算逻辑。

#### 3.3.3 一致性提示（仅描述现象与操作）

在 **汇总数据** 视图下，页面可能出现“一致性”相关提示：

- 若出现提示，可点击 **展开/收起** 查看下级明细列表。
- 明细通常用于辅助定位差异来源（例如下级对象的成本合计）。

#### 3.3.4 一致性校验设置（入口与按钮）

当处于 **汇总数据** 视图时，出现 **设置** 按钮入口，打开“一致性校验设置”对话框。

对话框通常包含：

- 阈值选择（预设值/自定义）
- 是否启用告警
- 告警级别（信息/警告/错误）

> 本手册不解释阈值含义与计算方式，仅说明可配置项与入口位置。

#### 3.3.5 图表阅读（趋势与结构）

成本分析通常包含：

- **趋势图**：按月份展示各成本分项走势（可用于识别异常月份）。
- **占比图**：展示成本结构（可用于识别主导成本项）。
- **总成本趋势**：用于观察合计成本变化。

---

### 3.4 对比分析（Tab：对比分析）

“对比分析”用于在同一年内比较不同对象（车间/产线）的成本结构差异。

#### 3.4.1 车间对比

- 选择“车间对比”后，图表会按车间维度展示各成本分项堆叠对比。
- 部分场景下支持 **直接数据 / 汇总数据** 按钮切换（如页面提供）。

#### 3.4.2 产线对比

- 选择“产线对比”后，可先选择车间（用于筛选该车间下的产线范围）。
- 图表会按产线维度展示各成本分项堆叠对比。

#### 3.4.3 无数据提示处理

若出现“暂无车间/产线成本数据”等提示，建议：

1. 回到 **成本录入**，确认当年对应车间/产线是否已录入至少一条记录。
2. 检查年份是否选择正确。
3. 检查层级与筛选条件是否选择了目标对象。

---

## 4. FAQ（常见问题）

### 4.1 为什么同一个月份会看到多条记录？

同月可按不同维度分别维护成本：全厂、不同车间、不同产线会形成多条独立记录。

### 4.2 为什么切换到车间/产线后看不到数据？

常见原因：

1. 该年份下未对该车间/产线录入成本记录。
2. 未选择具体车间/产线对象。
3. 年份选择不正确。

### 4.3 为什么对比分析提示暂无数据？

对比分析依赖对应维度（车间/产线）在该年份存在成本记录；请先在“成本录入”补齐数据。

### 4.4 为什么导出提示“暂无数据可导出”？

通常表示该年份没有任何成本记录；请确认年份后先新增至少一条记录再导出。

### 4.5 为什么汇总数据下出现一致性提示？

系统检测到“直接数据”与“汇总数据”存在差异时，会以提示形式展示；你可以展开查看下级明细辅助定位。

---

## 5. 附录

### 5.1 字段对照（录入）

| 字段 | 用途 |
|---|---|
| 能源购入费 / 药剂费 / 维修费 / 其他费用 | 成本分项金额 |
| 其他费用说明 | 仅对“其他费用”补充说明（可选） |
| 备注 | 对账口径、异常说明、凭证编号等（可选） |

### 5.2 视图模式字典（页面按钮）

- 直接数据（Direct）
- 汇总数据（Aggregated）

---

## 6. 版本更新记录

| 版本 | 日期 | 更新内容 |
|---|---|---|
| v1.0 | 2026-01 | 初始版本：成本录入、成本分析、对比分析、导出 |

